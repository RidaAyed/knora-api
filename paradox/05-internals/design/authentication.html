<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=v1.5.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../../cloud">
<title>Authentication in Knora · Knora Documentation</title>
<link rel="stylesheet" href="../../assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
<link rel="stylesheet" href="../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../lib/prettify/prettify.css">
<script src="../../lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../../assets/stylesheets/paradox-material-theme.css">
</head>
<body
data-md-color-primary="blue"
data-md-color-accent="yellow"
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../index.html" title="Knora Documentation" class="md-header-nav__button md-logo">
<i class="md-icon">cloud</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Knora Documentation
</span>
<span class="md-header-nav__topic">
Authentication in Knora
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/dhlab-basel/Knora/docs"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
dhlab-basel/Knora/docs
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">cloud</i>
</span>
<a href="../../index.html" title="Knora Documentation">
Knora Documentation
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/dhlab-basel/Knora/docs"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
dhlab-basel/Knora/docs
</div>
</a>

</div>
<ul>
  <li><a href="../../00-release-notes/index.html" class="page">Release Notes</a>
  <ul>
    <li><a href="../../00-release-notes/v1.1.0.html" class="page">v1.1.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.2.0.html" class="page">v1.2.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.3.0.html" class="page">v1.3.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.4.0.html" class="page">v1.4.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.5.0.html" class="page">v1.5.0 Release Notes</a></li>
    <li><a href="../../00-release-notes/v1.6.0.html" class="page">v1.6.0 Release Notes (not released yet)</a></li>
  </ul></li>
  <li><a href="../../01-introduction/index.html" class="page">Introduction</a>
  <ul>
    <li><a href="../../01-introduction/what-is-knora.html" class="page">What Is Knora?</a></li>
    <li><a href="../../01-introduction/example-project.html" class="page">An Example Project</a></li>
  </ul></li>
  <li><a href="../../02-knora-ontologies/index.html" class="page">Knora Ontologies</a>
  <ul>
    <li><a href="../../02-knora-ontologies/introduction.html" class="page">Introduction</a></li>
    <li><a href="../../02-knora-ontologies/knora-base.html" class="page">The Knora Base Ontology</a></li>
    <li><a href="../../02-knora-ontologies/salsah-gui.html" class="page">The SALSAH GUI Ontology</a></li>
  </ul></li>
  <li><a href="../../03-apis/index.html" class="page">The Knora APIs</a>
  <ul>
    <li><a href="../../03-apis/api-v1/index.html" class="page">Knora API v1</a></li>
    <li><a href="../../03-apis/api-v2/index.html" class="page">Knora API v2</a></li>
    <li><a href="../../03-apis/api-admin/index.html" class="page">Knora Admin API</a></li>
  </ul></li>
  <li><a href="../../04-deployment/index.html" class="page">Deploying Knora</a>
  <ul>
    <li><a href="../../04-deployment/getting-started.html" class="page">Getting Started with Knora</a></li>
  </ul></li>
  <li><a href="../../05-internals/index.html" class="page">Knora Internals</a>
  <ul>
    <li><a href="../../05-internals/design/index.html" class="page">Design</a></li>
    <li><a href="../../05-internals/development/index.html" class="page">Development</a></li>
  </ul></li>
  <li><a href="../../06-salsah/index.html" class="page">The SALSAH 1 GUI</a></li>
  <li><a href="../../07-sipi/index.html" class="page">The Sipi Media Server</a>
  <ul>
    <li><a href="../../07-sipi/setup-sipi-for-knora.html" class="page">Setting Up Sipi for Knora</a></li>
    <li><a href="../../07-sipi/sipi-and-knora.html" class="page">Interaction Between Sipi and Knora</a></li>
  </ul></li>
  <li><a href="../../faq.html" class="page">Frequently Asked Questions</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../../05-internals/design/authentication.html#authentication-in-knora" class="header">Authentication in Knora</a>
  <ul>
    <li><a href="../../05-internals/design/authentication.html#scope" class="header">Scope</a></li>
    <li><a href="../../05-internals/design/authentication.html#implementation" class="header">Implementation</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-v1" class="header">Usage V1</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-v2" class="header">Usage V2</a></li>
    <li><a href="../../05-internals/design/authentication.html#skipping-authentication" class="header">Skipping Authentication</a></li>
    <li><a href="../../05-internals/design/authentication.html#sipi-media-server-" class="header">Sipi (Media Server)</a></li>
    <li><a href="../../05-internals/design/authentication.html#improving-security" class="header">Improving Security</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> v1.5.0
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="../../05-internals/design/authentication.html#authentication-in-knora" class="header">Authentication in Knora</a>
  <ul>
    <li><a href="../../05-internals/design/authentication.html#scope" class="header">Scope</a></li>
    <li><a href="../../05-internals/design/authentication.html#implementation" class="header">Implementation</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-v1" class="header">Usage V1</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-v2" class="header">Usage V2</a></li>
    <li><a href="../../05-internals/design/authentication.html#skipping-authentication" class="header">Skipping Authentication</a></li>
    <li><a href="../../05-internals/design/authentication.html#sipi-media-server-" class="header">Sipi (Media Server)</a></li>
    <li><a href="../../05-internals/design/authentication.html#improving-security" class="header">Improving Security</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<!---
Copyright © 2015-2018 the contributors (see Contributors.md).

This file is part of Knora.

Knora is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Knora is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public
License along with Knora.  If not, see <http://www.gnu.org/licenses/>.
-->
<h1><a href="#authentication-in-knora" name="authentication-in-knora" class="anchor"><span class="anchor-link"></span></a>Authentication in Knora</h1>
<div class="toc ">
<ul>
  <li><a href="../../05-internals/design/authentication.html#scope" class="header">Scope</a></li>
  <li><a href="../../05-internals/design/authentication.html#implementation" class="header">Implementation</a></li>
  <li><a href="../../05-internals/design/authentication.html#usage-v1" class="header">Usage V1</a>
  <ul>
    <li><a href="../../05-internals/design/authentication.html#login-and-logout" class="header">Login and Logout</a></li>
    <li><a href="../../05-internals/design/authentication.html#submitting-credentials" class="header">Submitting Credentials</a></li>
    <li><a href="../../05-internals/design/authentication.html#checking-credentials" class="header">Checking Credentials</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-scenarios" class="header">Usage Scenarios</a></li>
  </ul></li>
  <li><a href="../../05-internals/design/authentication.html#usage-v2" class="header">Usage V2</a>
  <ul>
    <li><a href="../../05-internals/design/authentication.html#login-and-logout" class="header">Login and Logout</a></li>
    <li><a href="../../05-internals/design/authentication.html#submitting-credentials" class="header">Submitting Credentials</a></li>
    <li><a href="../../05-internals/design/authentication.html#checking-credentials" class="header">Checking Credentials</a></li>
    <li><a href="../../05-internals/design/authentication.html#usage-scenarios" class="header">Usage Scenarios</a></li>
  </ul></li>
  <li><a href="../../05-internals/design/authentication.html#skipping-authentication" class="header">Skipping Authentication</a></li>
  <li><a href="../../05-internals/design/authentication.html#sipi-media-server-" class="header">Sipi (Media Server)</a></li>
  <li><a href="../../05-internals/design/authentication.html#improving-security" class="header">Improving Security</a></li>
</ul>
</div>
<h2><a href="#scope" name="scope" class="anchor"><span class="anchor-link"></span></a>Scope</h2>
<p>Authentication is the process of making sure that if someone is accessing something then this someone is actually also the someone he pretends to be. The process of making sure that someone is authorized, i.e. has the permission to access something, is handled as described in <a href="../../02-knora-ontologies/knora-base.html#authorisation">Authorisation</a>).</p>
<h2><a href="#implementation" name="implementation" class="anchor"><span class="anchor-link"></span></a>Implementation</h2>
<p>The authentication in Knora is based on Basic Auth <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP basic authentication</a>, URL parameters, <a href="https://jwt.io">JSON Web Token</a>, and cookies. This means that on every request (to any of the routes), credentials need to be sent either via authorization header, URL parameters or cookie header.</p>
<p>All routes are always accessible and if there are no credentials provided, a default user is assumed. If credentials are sent and they are not correct (e.g., wrong username, password incorrect, token expired), then the request will end in an error message.</p>
<p>There are some differences in <code>V1</code> and <code>V2</code> of the API regarding authentication. They differ mainly in the format of the response and that creation of session cookies are only supported in <code>V1</code> and tokens in <code>V2</code>. After login via either version, all routes (<code>V1</code> and <code>V2</code>) are accessible.</p>
<h2><a href="#usage-v1" name="usage-v1" class="anchor"><span class="anchor-link"></span></a>Usage V1</h2>
<h3><a href="#login-and-logout" name="login-and-logout" class="anchor"><span class="anchor-link"></span></a>Login and Logout</h3>
<p>When a client accesses the <strong>/v1/session?login</strong> route successfully, it gets back headers requesting that a cookie is created, which will store the session token. On all subsequent calls to any route, this session token needs to be sent with each request. Normally, a web browser does this automatically, i.e. sends the cookie on every request. The session token is used by the server to retrieve the user profile. If successful, the user is deemed authenticated.</p>
<p>To <strong>logout</strong> the client can call the same route and provide the logout parameter <strong>/v1/session?logout</strong>. This will invalidate the session token and return headers for removing the cookie on the client.</p>
<h3><a href="#submitting-credentials" name="submitting-credentials" class="anchor"><span class="anchor-link"></span></a>Submitting Credentials</h3>
<p>For <strong>login</strong>, credentials in form of <em>email</em> and <em>password</em> need to be sent with the request.</p>
<p>There are two possibilities to do so:</p>
<ul>
  <li>in the URL submitting the parameters <code>email</code> and <code>password</code> (e.g., <a href="http://knora-host/v1/resources/resIri?email=userUrlEncodedEmail&password=pw">http://knora-host/v1/resources/resIri?email=userUrlEncodedEmail&password=pw</a>)</li>
  <li>in the HTTP authorization header (<a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP basic authentication</a>) when doing a HTTP request to the API When using Python&rsquo;s module <code>requests</code>, the credentials can simply be submitted as a tuple with each request using the param <code>auth</code> (<a href="http://docs.python-requests.org/en/master/user/authentication/#basic-authentication">python requests</a>).</li>
</ul>
<p>An alternative way for accessing all routes is to simply supply the <em>email</em> and <em>password</em> credentials on each request either as URL parameters or in the HTTP authorization header.</p>
<h3><a href="#checking-credentials" name="checking-credentials" class="anchor"><span class="anchor-link"></span></a>Checking Credentials</h3>
<p>To check the credentials, there is a special route called <strong>/v1/authenticate</strong>, which can be used to check if the credentials are valid.</p>
<h3><a href="#usage-scenarios" name="usage-scenarios" class="anchor"><span class="anchor-link"></span></a>Usage Scenarios</h3>
<ol>
  <li>Create session by logging-in, send session token on each subsequent request, and logout when finished.</li>
  <li>Send email/password credentials on every request.</li>
</ol>
<h2><a href="#usage-v2" name="usage-v2" class="anchor"><span class="anchor-link"></span></a>Usage V2</h2>
<h3><a href="#login-and-logout" name="login-and-logout" class="anchor"><span class="anchor-link"></span></a>Login and Logout</h3>
<p>A client sends a POST request (e.g., <code>{&quot;email&quot;:&quot;usersemail&quot;,
&quot;password&quot;:&quot;userspassword&quot;}</code>) to the <strong>/v2/authentication</strong> route with <em>email</em> and <em>password</em> in the body. If the credentials are valid, a <a href="https://jwt.io">JSON WEB Token</a> (JWT) will be sent back in the response (e.g., <code>{&quot;token&quot;: &quot;eyJ0eXAiOiJ...&quot;}</code>). On all subsequent calls to any route, this token can be sent with each request (instead of <em>email</em>/*password*). If the token is successfully validated, then the user is deemed authenticated.</p>
<p>To <strong>logout</strong> the client sends a DELETE request to the same route <strong>/v2/authentication</strong> and the token (either as an URL parameter or authorization header). This will invalidate the token.</p>
<h3><a href="#submitting-credentials" name="submitting-credentials" class="anchor"><span class="anchor-link"></span></a>Submitting Credentials</h3>
<p>When accessing any route and <em>email</em>/*password* credentials would need to be sent, we support two options to do so:</p>
<ul>
  <li>in the URL submitting the parameters <code>email</code> and <code>password</code>  (e.g., <a href="http://knora-host/v1/resources/resIri?email=userUrlEncodedEmail&password=pw">http://knora-host/v1/resources/resIri?email=userUrlEncodedEmail&password=pw</a>)</li>
  <li>in the HTTP header (<a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP basic  authentication</a>)  when doing a HTTP request to the API When using Python&rsquo;s module  <code>requests</code>, the credentials can simply be submitted as a tuple  with each request using the param <code>auth</code> (<a href="http://docs.python-requests.org/en/master/user/authentication/#basic-authentication">python  requests</a>).</li>
</ul>
<p>When accessing any route and the <em>token</em> would need to be sent, we support two options to do so:</p>
<ul>
  <li>in the URL submitting the parameter <code>token</code> (e.g.,  <a href="http://knora-host/v1/resources/resIri?token=1234567890">http://knora-host/v1/resources/resIri?token=1234567890</a>)</li>
  <li>in the HTTP authorization header with the  <a href="http://tools.ietf.org/html/rfc6750#section-2.1">HTTP bearer scheme</a>.</li>
</ul>
<h3><a href="#checking-credentials" name="checking-credentials" class="anchor"><span class="anchor-link"></span></a>Checking Credentials</h3>
<p>To check the credentials, there is a special route called <strong>/v1/authenticate</strong>, which can be used to check if the credentials are valid.</p>
<h3><a href="#usage-scenarios" name="usage-scenarios" class="anchor"><span class="anchor-link"></span></a>Usage Scenarios</h3>
<ol>
  <li>Create token by logging-in, send token on each subsequent request, and logout when finished.</li>
  <li>Send email/password credentials on every request.</li>
</ol>
<h2><a href="#skipping-authentication" name="skipping-authentication" class="anchor"><span class="anchor-link"></span></a>Skipping Authentication</h2>
<p>There is the possibility to turn skipping authentication on and use a hardcoded user (Test User). In <strong>application.conf</strong> set the <code>skip-authentication = true</code> and Test User will be always assumed.</p>
<h2><a href="#sipi-media-server-" name="sipi-media-server-" class="anchor"><span class="anchor-link"></span></a>Sipi (Media Server)</h2>
<p>For authentication to work with the media server, we need to add support for cookies. At the moment the SALSAH-App would set BasicAuth heathers, but this only works for AJAX requests using <code>SALSAH.ApiGet</code> (<code>Put</code>, etc.). Since the medias are embedded as source tags, the browser would get them on his own, and doesn&rsquo;t know anything about the needed AuthHeathers. With cookies, the browser would send those automatically with every request. The media server can use the credentials of the user requesting something for accessing the RepresentationsRouteV1, i.e. make this request in the name of the user so to speak, then the RepresentationResponderV1 should have all the information it needs to filter the result based on the users permissions.</p>
<h2><a href="#improving-security" name="improving-security" class="anchor"><span class="anchor-link"></span></a>Improving Security</h2>
<p>In the first iteration, the email/password would be sent in clear text. Since we will use HTTPS this shouldn&rsquo;t be a problem. The second iteration, could encrypt the email/password.</p>
</div>
<div>
<a href="https://github.com/dhlab-basel/Knora/tree/master/src/paradox/05-internals/design/authentication.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
v1.5.0
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../../05-internals/design/consistency-checking.html" title="Consistency Checking" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Consistency Checking
</span>
</div>
</a>
<a href="../../05-internals/design/administration.html" title="Administration (Users, Projects, Groups, Institutions, Permissions)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Administration (Users, Projects, Groups, Institutions, Permissions)
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
Copyright 2015-2018 the contributors (see Contributors.md)
</div>
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
<a href="https://github.com/dhlab-basel" class="md-footer-social__link fa fa-github"></a><a href="https://twitter.com/dhlabbasel" class="md-footer-social__link fa fa-twitter"></a>
</div>

</div>
</div>
</footer>

</div>
<script src="../../assets/javascripts/application.5165553b.js"></script>
<script src="../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../."}})</script>
<script type="text/javascript" src="../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
